<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>åœ°ç†çµ±è¨ˆã‚¯ã‚¤ã‚º</title>
<style>
body { font-family: system-ui, sans-serif; margin:0; padding:20px; background:#f5f5f5; }
.card { background:white; padding:20px; border-radius:12px; box-shadow:0 2px 10px rgba(0,0,0,0.1); max-width:500px; margin:auto; }
h1 { font-size:1.5rem; text-align:center; }

.tabs { display:flex; justify-content:space-around; margin-bottom:15px; }
.tab { flex:1; font-size:0.8rem; padding:8px; border:none; background:#99d7ff; border-radius:6px; text-align:center; }
.tab.active { background:#007aff; color:white; }

button.main { width:100%; padding:14px; margin-top:15px; font-size:1.1rem; border:none; border-radius:8px; background:#007aff; color:white; }
button.small { width:100%; padding:10px; margin-top:10px; font-size:1rem; border:none; border-radius:8px; }

#choices { display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:15px; }
.choice-btn { background:#007aff; color:white; border-radius:8px; padding:10px; border:none; }
.choice-btn.selected { background:#99d7ff; color:#333; }

#streak { text-align:right; font-size:0.9rem; margin-top:-10px; color:#ff9933; }

.result-box, .comment-box { margin-top:20px; padding:10px; border-radius:8px; background:#eef; }

#answerBlock { margin-top:20px; display:block; }
</style>
</head>
<body>
<div class="card">
  <div class="tabs">
    <div class="tab active" data-genre="agri">è¾²æ—æ°´ç”£æ¥­</div>
    <div class="tab" data-genre="energy">ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ»é‰±å·¥æ¥­</div>
    <div class="tab" data-genre="other">ãã®ä»–</div>
  </div>

  <h1 id="quiz-title">â—<span style="font-size:0.8em;">ã®</span>è¼¸å‡ºé‡</h1>
  <p id="instruction">1ä½ â†’ 2ä½ â†’ 3ä½ ã®é †ã§å›½ã‚’é¸ã‚“ã§ãã ã•ã„</p>
  <div id="streak"></div>
  <div id="choices"></div>

  <div id="answerBlock">
    <strong>ã‚ãªãŸã®å›ç­”:</strong>
    <ol id="answers"></ol>
  </div>

  <button id="checkBtn" class="main" onclick="checkAnswer()" disabled>ç¢ºå®š</button>
  <button id="newQuizBtn" class="small" onclick="newQuiz()" style="display:none; background:#28a745; color:white;">æ–°ã—ã„å•é¡Œ</button>
</div>

<script>
const quizSets = {
  agri: [
    { 
      title:"å°éº¦ã®è¼¸å‡ºé‡", 
      choices:["ã‚¢ãƒ¡ãƒªã‚«","ã‚«ãƒŠãƒ€","ãƒ•ãƒ©ãƒ³ã‚¹","ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢","ãƒ­ã‚·ã‚¢","ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³","ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠ","ã‚¤ãƒ³ãƒ‰","ãƒ‰ã‚¤ãƒ„","ä¸­å›½"], 
      answer:["ãƒ­ã‚·ã‚¢","ã‚«ãƒŠãƒ€","ã‚¢ãƒ¡ãƒªã‚«"], 
      comment:"ä¸–ç•Œã§ä¸€ç•ªã®è¼¸å‡ºå›½ã¯ãƒ­ã‚·ã‚¢ã ã‚ˆã€‚" 
    },
    { 
      title:"ç±³ã®ç”Ÿç”£é‡", 
      choices:["ä¸­å›½","ã‚¤ãƒ³ãƒ‰","ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢","ãƒãƒ³ã‚°ãƒ©ãƒ‡ã‚·ãƒ¥","ãƒ™ãƒˆãƒŠãƒ ","ã‚¿ã‚¤","æ—¥æœ¬","éŸ“å›½","ãƒ–ãƒ©ã‚¸ãƒ«","ãƒŸãƒ£ãƒ³ãƒãƒ¼"], 
      answer:["ä¸­å›½","ã‚¤ãƒ³ãƒ‰","ã‚¤ãƒ³ãƒ‰ãƒã‚·ã‚¢"], 
      comment:"ä¸­å›½ãŒæ–­ãƒˆãƒ„ã§ãƒˆãƒƒãƒ—ã ã­ã€‚" 
    }
  ],
  energy: [
    { 
      title:"çŸ³æ²¹ã®ç”Ÿç”£é‡",
      choices:["ã‚¢ãƒ¡ãƒªã‚«","ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢","ãƒ­ã‚·ã‚¢","ã‚«ãƒŠãƒ€","ã‚¤ãƒ©ã‚¯","UAE","ä¸­å›½","ã‚¤ãƒ©ãƒ³","ãƒ–ãƒ©ã‚¸ãƒ«","ã‚¯ã‚¦ã‚§ãƒ¼ãƒˆ"],
      answer:["ã‚¢ãƒ¡ãƒªã‚«","ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢","ãƒ­ã‚·ã‚¢"],
      comment:"ã‚¢ãƒ¡ãƒªã‚«ãŒé¦–ä½ã€æ¬¡ã«ã‚µã‚¦ã‚¸ã¨ãƒ­ã‚·ã‚¢ã€‚" 
    },
    { 
      title:"é‰„é‰±çŸ³ã®ç”Ÿç”£é‡",
      choices:["ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢","ãƒ–ãƒ©ã‚¸ãƒ«","ä¸­å›½","ã‚¤ãƒ³ãƒ‰","ãƒ­ã‚·ã‚¢","å—ã‚¢ãƒ•ãƒªã‚«","ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠ","ã‚«ãƒŠãƒ€","ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³","ã‚¤ãƒ©ãƒ³"],
      answer:["ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢","ãƒ–ãƒ©ã‚¸ãƒ«","ä¸­å›½"],
      comment:"" 
    }
  ],
  other: [
    { 
      title:"è¦³å…‰å®¢æ•°ï¼ˆå›½åˆ¥ï¼‰",
      choices:["ãƒ•ãƒ©ãƒ³ã‚¹","ã‚¹ãƒšã‚¤ãƒ³","ã‚¢ãƒ¡ãƒªã‚«","ä¸­å›½","ã‚¤ã‚¿ãƒªã‚¢","ãƒˆãƒ«ã‚³","ãƒ¡ã‚­ã‚·ã‚³","ãƒ‰ã‚¤ãƒ„","è‹±å›½","ã‚¿ã‚¤"],
      answer:["ãƒ•ãƒ©ãƒ³ã‚¹","ã‚¹ãƒšã‚¤ãƒ³","ã‚¢ãƒ¡ãƒªã‚«"],
      comment:"ãƒ•ãƒ©ãƒ³ã‚¹ã¯è¦³å…‰å¤§å›½ã€‚" 
    },
    { 
      title:"ã‚¹ãƒãƒ›æ™®åŠç‡",
      choices:["éŸ“å›½","UAE","ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«","å°æ¹¾","æ—¥æœ¬","ã‚¢ãƒ¡ãƒªã‚«","è‹±å›½","ä¸­å›½","ã‚«ãƒŠãƒ€","ã‚ªãƒ¼ã‚¹ãƒˆãƒ©ãƒªã‚¢"],
      answer:["éŸ“å›½","UAE","ã‚·ãƒ³ã‚¬ãƒãƒ¼ãƒ«"],
      comment:"éŸ“å›½ã¨UAEãŒãƒˆãƒƒãƒ—ã‚¯ãƒ©ã‚¹ã€‚" 
    }
  ]
};

let currentGenre = "agri";
let currentQuiz = null;
let userAnswers = [];
let streak = 0;

function shuffle(arr) {
  const a = arr.slice();
  for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; }
  return a;
}

// ã‚¸ãƒ£ãƒ³ãƒ«åˆ‡æ›¿
document.querySelectorAll('.tab').forEach(tab=>{
  tab.addEventListener('click',()=>{
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    tab.classList.add('active');
    currentGenre = tab.dataset.genre;
    newQuiz();
  });
});

function updateStreak(){
  const s=document.getElementById('streak');
  s.textContent = streak>=1?`ğŸ¯ ${streak}å•é€£ç¶šæ­£è§£ï¼`:"";
}

function newQuiz(){
  const old=document.querySelector('.result-box');
  if(old) old.remove();
  const oldC=document.querySelector('.comment-box');
  if(oldC) oldC.remove();

  userAnswers=[];
  document.getElementById('answers').innerHTML='';
  document.getElementById('answerBlock').style.display='block';
  document.getElementById('choices').style.display='grid';
  document.getElementById('checkBtn').style.display='block';
  document.getElementById('checkBtn').disabled=true;
  document.getElementById('checkBtn').style.background='#aaa';
  document.getElementById('newQuizBtn').style.display='none';

  currentQuiz = shuffle(quizSets[currentGenre])[0];
  document.getElementById('quiz-title').innerHTML = currentQuiz.title.replace('ã®', 'â—<span style="font-size:0.8em;">ã®</span>');

  const box=document.getElementById('choices');
  box.innerHTML='';
  shuffle(currentQuiz.choices).forEach(name=>{
    const btn=document.createElement('button');
    btn.textContent=name;
    btn.className='choice-btn';
    btn.addEventListener('click',()=>toggleSelect(name,btn));
    box.appendChild(btn);
  });
}

function toggleSelect(name,btn){
  const idx=userAnswers.indexOf(name);
  if(idx!==-1){
    userAnswers.splice(idx,1);
    btn.classList.remove('selected');
  }else{
    if(userAnswers.length>=3) return;
    userAnswers.push(name);
    btn.classList.add('selected');
  }
  const list=document.getElementById('answers');
  list.innerHTML='';
  userAnswers.forEach(a=>{
    const li=document.createElement('li');
    li.textContent=a;
    list.appendChild(li);
  });
  const checkBtn=document.getElementById('checkBtn');
  if(userAnswers.length===3){
    checkBtn.disabled=false;
    checkBtn.style.background='#28a745';
  }else{
    checkBtn.disabled=true;
    checkBtn.style.background='#aaa';
  }
}

function checkAnswer(){
  const correct=currentQuiz.answer;

  document.getElementById('answerBlock').style.display='none';
  document.getElementById('choices').style.display='none';
  document.getElementById('checkBtn').style.display='none';
  document.getElementById('newQuizBtn').style.display='block';

  let allCorrect=true;
  for(let i=0;i<3;i++) if(correct[i]!==userAnswers[i]) allCorrect=false;
  if(allCorrect) streak++; else streak=0;
  updateStreak();

  const result=document.createElement('div');
  result.className='result-box';
  let html='<strong>çµæœ:</strong><br><br>';
  for(let i=0;i<3;i++){
    const ok=(userAnswers[i]===correct[i]);
    const icon=ok?'â­•':'âŒ';
    const color=ok?'#28a745':'#d00';
    html+=`${icon} ${i+1}ä½ â†’ <span style="color:${color}">ã‚ãªãŸ: ${userAnswers[i]||'-'} / æ­£è§£: ${correct[i]}</span><br>`;
  }
  result.innerHTML=html;
  document.querySelector('.card').appendChild(result);

  if(currentQuiz.comment && currentQuiz.comment.trim()!==''){
    const commentBox=document.createElement('div');
    commentBox.className='comment-box';
    commentBox.textContent=currentQuiz.comment;
    document.querySelector('.card').insertBefore(commentBox, document.getElementById('newQuizBtn'));
  }
}

newQuiz();
</script>
</body>
</html>
