<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>地理統計クイズ</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      margin: 0;
      padding: 20px;
      background: #f5f5f5;
    }
    .card {
      background: white;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      max-width: 500px;
      margin: auto;
    }
    h1 {
      font-size: 1.5rem;
      text-align: center;
    }
    button {
      width: 100%;
      padding: 14px;
      margin-top: 15px;
      font-size: 1.1rem;
      border: none;
      border-radius: 8px;
      background: #007aff;
      color: white;
    }
    button:active {
      opacity: 0.7;
    }
    #question {
      margin-top: 20px;
      font-size: 1.2rem;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1 id="quiz-title">●●の輸出量ランキング</h1>

    <p id="instruction">1位 → 2位 → 3位 の順で国を選んでください</p>

    <div id="choices" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px;">
      <!-- 選択肢10個が入る -->
    </div>

    <div style="margin-top: 20px;">
      <strong>あなたの回答:</strong>
      <ol id="answers"></ol>
    </div>

    <button id="checkBtn" onclick="checkAnswer()" style="background:#aaa; margin-bottom:15px; width:100%; padding:14px; border:none; border-radius:8px; font-size:1.1rem;" disabled>確定</button>
    <button id="newQuizBtn" onclick="newQuiz()" style="display:none; margin-top:10px;">新しい問題</button>
  </div>

  <script>
    const quizData = [
      {
        title: "小麦の輸出量",
        choices: ["アメリカ","カナダ","フランス","オーストラリア","ロシア","アルゼンチン","ウクライナ","インド","ドイツ","中国"],
        answer: ["ロシア","カナダ","アメリカ"]
      },
      {
        title: "石油の生産量",
        choices: ["アメリカ","サウジアラビア","ロシア","カナダ","イラク","UAE","中国","イラン","ブラジル","クウェート"],
        answer: ["アメリカ","サウジアラビア","ロシア"]
      }
    ];

    let currentQuiz;
    let userAnswers = [];
    let selectedButtons = {};
    let checkBtn;
    let newBtn;

    function newQuiz() {
      currentQuiz = quizData[Math.floor(Math.random() * quizData.length)];
      document.getElementById("quiz-title").textContent = currentQuiz.title + " ランキング";

      const box = document.getElementById("choices");
      box.innerHTML = "";
      box.style.display = "grid";

      selectedButtons = {};

      currentQuiz.choices.forEach(name => {
        const btn = document.createElement("button");
        btn.textContent = name;
        btn.style.padding = "10px";
        btn.style.borderRadius = "8px";
        btn.style.background = "#007aff";
        btn.style.color = "white";
        btn.onclick = () => toggleSelect(name, btn);
        box.appendChild(btn);
      });

      userAnswers = [];
      document.getElementById("answers").innerHTML = "";

      checkBtn = document.getElementById("checkBtn");
      checkBtn.style.display = "block";
      checkBtn.disabled = true;
      checkBtn.style.background = "#aaa";

      document.querySelector("#newQuizBtn").style.display = "none";
    }

    function toggleSelect(name, btn) {
      if (selectedButtons[name]) {
        // 取り消し
        selectedButtons[name] = false;
        btn.style.background = "#007aff";
        btn.style.color = "white";
        btn.disabled = false;

        const idx = userAnswers.indexOf(name);
        if (idx !== -1) userAnswers.splice(idx, 1);

      } else {
        if (userAnswers.length >= 3) return;

        selectedButtons[name] = true;
        btn.style.background = "#ccc";
        btn.style.color = "#666";
        btn.disabled = false;

        userAnswers.push(name);
      }

      updateAnswerList();
    }

    function updateAnswerList() {
      const list = document.getElementById("answers");
      list.innerHTML = "";
      userAnswers.forEach(a => {
        const li = document.createElement("li");
        li.textContent = a;
        list.appendChild(li);
      });

      if (userAnswers.length === 3) {
        checkBtn.disabled = false;
        checkBtn.style.background = "#28a745";
      } else {
        checkBtn.disabled = true;
        checkBtn.style.background = "#aaa";
      }
    }

    function checkAnswer() {
      if (userAnswers.length < 3) return;
      const correct = currentQuiz.answer;

      document.getElementById('choices').style.display = 'none';

      checkBtn.style.display = 'none';
      document.querySelector('#newQuizBtn').style.display = 'block';

      const resultBox = document.createElement('div');
      resultBox.id = 'result';
      resultBox.style.marginTop = '20px';
      resultBox.style.padding = '10px';
      resultBox.style.background = '#eef';
      resultBox.style.borderRadius = '8px';

      let html = "<strong>結果:</strong><br><br>";
      for (let i = 0; i < 3; i++) {
        const ok = (userAnswers[i] === correct[i]);
        const icon = ok ? '⭕' : '❌';
        const color = ok ? '#28a745' : '#d00';
        html += `${icon} ${i+1}位 → <span style='color:${color}'>あなた: ${userAnswers[i]}</span> / 正解: ${correct[i]}<br>`;
      }

      resultBox.innerHTML = html;

      const card = document.querySelector('.card');
      card.insertBefore(resultBox, document.getElementById('answers').parentElement);
    }

    newQuiz();
  </script>
</body>
</html>
